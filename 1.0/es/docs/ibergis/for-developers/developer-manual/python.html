<!DOCTYPE html>
<html class="writer-html5" lang="es" data-content_root="../../../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>3. Código Python &mdash; documentación de IberGIS Documentation - </title>
      <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/css/ibergis_docs.css?v=3f46d377" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/togglebutton.css?v=13237357" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/copybutton.css?v=76b2166b" />

  
    <link rel="shortcut icon" href="../../../../_static/logo.png"/>
    <link rel="canonical" href="https://ibergis.github.io/testing/en/docs/ibergis/for-developers/developer-manual/python.html" />
  <!--[if lt IE 9]>
    <script src="../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../../../_static/documentation_options.js?v=e2bb6099"></script>
        <script src="../../../../_static/doctools.js?v=9a2dae69"></script>
        <script src="../../../../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="../../../../_static/clipboard.min.js?v=a7894cd8"></script>
        <script src="../../../../_static/copybutton.js?v=f281be69"></script>
        <script>let toggleHintShow = 'Click to show';</script>
        <script>let toggleHintHide = 'Click to hide';</script>
        <script>let toggleOpenOnPrint = 'true';</script>
        <script src="../../../../_static/togglebutton.js?v=4a39c7ea"></script>
        <script src="../../../../_static/translations.js?v=d190bf04"></script>
        <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
        <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../../../_static/js/theme.js"></script>
    <link rel="index" title="Índice" href="../../../../genindex.html" />
    <link rel="search" title="Búsqueda" href="../../../../search.html" />
    <link rel="next" title="4. Ejemplos" href="examples.html" />
    <link rel="prev" title="2. Modelo de Base de Datos" href="dbmodel.html" />
<meta
	name="description"
	content="IberGIS 1.0 documentation: 3. Código Python"
/>
</head>

<body class="wy-body-for-nav">

<nav class="release_status_topbar">
</nav>

  
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" > 

          
          
          <a href="../../../index.html" class="icon icon-home">
            IberGIS Documentation
              <img src="../../../../_static/logo.png" class="logo" alt="Logotipo"/>
          </a>
              <div class="version">
                1.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Buscar documentos" aria-label="Buscar documentos" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
<a href="../../../../genindex.html">Índice</a>

        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">PARA USUARIOS</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../for-users/user-manual/index.html">Manual de Usuario de IberGIS</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">PARA DESARROLLADORES</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Manual de Desarrollador de IberGIS</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="introduction.html">1. Introducción</a></li>
<li class="toctree-l2"><a class="reference internal" href="dbmodel.html">2. Modelo de Base de Datos</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">3. Código Python</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#plugin-location">3.1. Ubicación del Plugin</a></li>
<li class="toctree-l3"><a class="reference internal" href="#folder-structure">3.2. Estructura de Carpetas</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#top-level">3.2.1. Nivel Superior</a></li>
<li class="toctree-l4"><a class="reference internal" href="#core-package">3.2.2. Paquete Core</a></li>
<li class="toctree-l4"><a class="reference internal" href="#lib-package">3.2.3. Paquete Lib</a></li>
<li class="toctree-l4"><a class="reference internal" href="#third-party-packages">3.2.4. Paquetes de Terceros</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#python-coding-rules">3.3. Reglas de Codificación Python</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#general-style">3.3.1. Estilo General</a></li>
<li class="toctree-l4"><a class="reference internal" href="#naming-conventions">3.3.2. Convenciones de Nomenclatura</a></li>
<li class="toctree-l4"><a class="reference internal" href="#global-variables">3.3.3. Variables Globales</a></li>
<li class="toctree-l4"><a class="reference internal" href="#configuration-handling">3.3.4. Manejo de Configuración</a></li>
<li class="toctree-l4"><a class="reference internal" href="#error-handling-and-logging">3.3.5. Manejo de Errores y Registro</a></li>
<li class="toctree-l4"><a class="reference internal" href="#threaded-operations">3.3.6. Operaciones en Hilos</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#working-with-qgis-and-qt">3.4. Trabajando con QGIS y Qt</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#integration-with-qgis">3.4.1. Integración con QGIS</a></li>
<li class="toctree-l4"><a class="reference internal" href="#qt-widgets-and-dialogs">3.4.2. Widgets y Diálogos Qt</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#adding-new-code">3.5. Añadiendo Nuevo Código</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="examples.html">4. Ejemplos</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">PARA ADMINISTRADORES</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../for-admins/index.html">Documentación para Administradores</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">IberGIS Documentation</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Manual del Desarrollador de IberGIS</a></li>
      <li class="breadcrumb-item active"><span class="section-number">3. </span>Código Python</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/IberGIS/IberGIS-Documentation/blob/master/docs/ibergis/for-developers/developer-manual/python.rst" class="fa fa-github"> Editar en GitHub</a>
      </li>
  </ul><div class="rst-breadcrumbs-buttons" role="navigation" aria-label="Sequential page navigation">
        <a href="dbmodel.html" class="btn btn-neutral float-left" title="2. Modelo de Base de Datos" accesskey="p"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Anterior</a>
        <a href="examples.html" class="btn btn-neutral float-right" title="4. Ejemplos" accesskey="n">Siguiente <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
  </div>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="python-code">
<h1><span class="section-number">3. </span>Código Python<a class="headerlink" href="#python-code" title="Link to this heading"></a></h1>
<nav class="contents local" id="contenido">
<ul class="simple">
<li><p><a class="reference internal" href="#plugin-location" id="id1">Ubicación del Plugin</a></p></li>
<li><p><a class="reference internal" href="#folder-structure" id="id2">Estructura de Carpetas</a></p>
<ul>
<li><p><a class="reference internal" href="#top-level" id="id3">Nivel Superior</a></p></li>
<li><p><a class="reference internal" href="#core-package" id="id4">Paquete Core</a></p></li>
<li><p><a class="reference internal" href="#lib-package" id="id5">Paquete Lib</a></p></li>
<li><p><a class="reference internal" href="#third-party-packages" id="id6">Paquetes de Terceros</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#python-coding-rules" id="id7">Reglas de Codificación Python</a></p>
<ul>
<li><p><a class="reference internal" href="#general-style" id="id8">Estilo General</a></p></li>
<li><p><a class="reference internal" href="#naming-conventions" id="id9">Convenciones de Nomenclatura</a></p></li>
<li><p><a class="reference internal" href="#global-variables" id="id10">Variables Globales</a></p></li>
<li><p><a class="reference internal" href="#configuration-handling" id="id11">Manejo de Configuración</a></p></li>
<li><p><a class="reference internal" href="#error-handling-and-logging" id="id12">Manejo de Errores y Registro</a></p></li>
<li><p><a class="reference internal" href="#threaded-operations" id="id13">Operaciones en Hilos</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#working-with-qgis-and-qt" id="id14">Trabajando con QGIS y Qt</a></p>
<ul>
<li><p><a class="reference internal" href="#integration-with-qgis" id="id15">Integración con QGIS</a></p></li>
<li><p><a class="reference internal" href="#qt-widgets-and-dialogs" id="id16">Widgets y Diálogos Qt</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#adding-new-code" id="id17">Añadiendo Nuevo Código</a></p></li>
</ul>
</nav>
<p>Esta sección describe cómo está organizado el código Python de IberGIS y qué reglas de codificación se siguen en la implementación del plugin QGIS.</p>
<section id="plugin-location">
<h2><a class="toc-backref" href="#id1" role="doc-backlink"><span class="section-number">3.1. </span>Ubicación del Plugin</a><a class="headerlink" href="#plugin-location" title="Link to this heading"></a></h2>
<p>El plugin IberGIS de QGIS se instala en el perfil de usuario bajo:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">C</span><span class="p">:</span>\<span class="n">Users</span>\<span class="o">&lt;</span><span class="n">USER</span><span class="o">&gt;</span>\<span class="n">AppData</span>\<span class="n">Roaming</span>\<span class="n">QGIS</span>\<span class="o">&lt;</span><span class="n">VERSION</span><span class="o">&gt;</span>\<span class="n">profiles</span>\<span class="o">&lt;</span><span class="n">PROFILE</span><span class="o">&gt;</span>\<span class="n">python</span>\<span class="n">plugins</span>\<span class="o">&lt;</span><span class="n">IBERGIS_FOLDER</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>En esta documentación nos referiremos a este directorio como la <em>raíz del plugin</em>.</p>
</section>
<section id="folder-structure">
<h2><a class="toc-backref" href="#id2" role="doc-backlink"><span class="section-number">3.2. </span>Estructura de Carpetas</a><a class="headerlink" href="#folder-structure" title="Link to this heading"></a></h2>
<p>Las subcarpetas más relevantes dentro de la raíz del plugin son:</p>
<section id="top-level">
<h3><a class="toc-backref" href="#id3" role="doc-backlink"><span class="section-number">3.2.1. </span>Nivel Superior</a><a class="headerlink" href="#top-level" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p><strong>main.py</strong></p>
<ul>
<li><p>Punto de entrada para el plugin QGIS.</p></li>
<li><p>Contiene la clase principal (<code class="docutils literal notranslate"><span class="pre">Drain</span></code>) que QGIS instancia y que conecta el plugin a la interfaz de QGIS.</p></li>
<li><p>Implementa métodos como <code class="docutils literal notranslate"><span class="pre">initGui()</span></code> y <code class="docutils literal notranslate"><span class="pre">unload()</span></code> que son llamados por QGIS para crear menús, barras de herramientas y limpiarlos.</p></li>
</ul>
</li>
<li><p><strong>global_vars.py</strong></p>
<ul>
<li><p>Módulo central que almacena el estado global utilizado en todo el plugin (rutas, instancia de interfaz QGIS, objetos de configuración, registradores, etc.).</p></li>
<li><p>Proporciona funciones auxiliares para inicializar estas variables globales cuando el plugin inicia.</p></li>
</ul>
</li>
<li><p><strong>config/</strong></p>
<ul>
<li><p>Contiene archivos de configuración predeterminados utilizados por el plugin (por ejemplo <code class="docutils literal notranslate"><span class="pre">drain.config</span></code> y <code class="docutils literal notranslate"><span class="pre">user_params.config</span></code>).</p></li>
<li><p>Los valores de estos archivos son leídos por funciones auxiliares en <code class="docutils literal notranslate"><span class="pre">core.utils.tools_dr</span></code>.</p></li>
</ul>
</li>
<li><p><strong>dbmodel/</strong></p>
<ul>
<li><p>Contiene los scripts SQL utilizados para crear y actualizar el esquema de base de datos GeoPackage utilizado por los proyectos IberGIS.</p></li>
<li><p>Esta carpeta se describe en detalle en <a class="reference internal" href="dbmodel.html"><span class="doc">Modelo de Base de Datos</span></a>.</p></li>
</ul>
</li>
<li><p><strong>resources/</strong></p>
<ul>
<li><p>Contiene datos auxiliares utilizados por el plugin: proyectos de ejemplo, scripts, plantillas, estilos de resultados, etc.</p></li>
</ul>
</li>
<li><p><strong>icons/</strong> and <strong>i18n/</strong></p>
<ul>
<li><p>Almacena iconos y archivos de traducción utilizados por la interfaz de usuario.</p></li>
</ul>
</li>
</ul>
</section>
<section id="core-package">
<h3><a class="toc-backref" href="#id4" role="doc-backlink"><span class="section-number">3.2.2. </span>Paquete Core</a><a class="headerlink" href="#core-package" title="Link to this heading"></a></h3>
<ul>
<li><p><strong>core/</strong></p>
<ul class="simple">
<li><p>Contiene la mayor parte de la lógica de aplicación específica del plugin IberGIS.</p></li>
</ul>
<p>Los subpaquetes importantes dentro de <code class="docutils literal notranslate"><span class="pre">core/</span></code> son:</p>
<ul class="simple">
<li><p><strong>core/admin/</strong></p>
<ul>
<li><p>Herramientas administrativas y diálogos (por ejemplo, herramientas de mantenimiento de base de datos y asistentes de configuración de proyectos).</p></li>
</ul>
</li>
<li><p><strong>core/models/</strong></p>
<ul>
<li><p>Clases Python que representan objetos de dominio de alto nivel utilizados por el plugin (proyectos, capas, modelos de configuración, etc.).</p></li>
</ul>
</li>
<li><p><strong>core/processing/</strong></p>
<ul>
<li><p>Algoritmos de procesamiento QGIS implementados por IberGIS. Estas son las herramientas que aparecen en la caja de herramientas de procesamiento de QGIS bajo los grupos IberGIS.</p></li>
<li><p>Cada archivo <code class="docutils literal notranslate"><span class="pre">*.py</span></code> generalmente implementa un algoritmo y sigue la API estándar de procesamiento QGIS.</p></li>
</ul>
</li>
<li><p><strong>core/shared/</strong></p>
<ul>
<li><p>Módulos compartidos por diferentes partes del plugin central, por ejemplo constantes comunes o clases auxiliares.</p></li>
</ul>
</li>
<li><p><strong>core/threads/</strong></p>
<ul>
<li><p>Tareas en hilos que realizan operaciones de larga duración (importaciones, validaciones, simulaciones, etc.) sin bloquear la interfaz de usuario de QGIS.</p></li>
</ul>
</li>
<li><p><strong>core/toolbars/</strong></p>
<ul>
<li><p>Código que construye y gestiona las barras de herramientas y botones de IberGIS en la interfaz de usuario de QGIS.</p></li>
</ul>
</li>
<li><p><strong>core/ui/</strong></p>
<ul>
<li><p>Archivos <code class="docutils literal notranslate"><span class="pre">.ui</span></code> (Qt Designer) y envoltorios Python utilizados para construir diálogos y widgets acoplables.</p></li>
<li><p>El módulo <code class="docutils literal notranslate"><span class="pre">ui_manager.py</span></code> ayuda a cargar y gestionar estos formularios.</p></li>
</ul>
</li>
<li><p><strong>core/utils/</strong></p>
<ul>
<li><p>Colección de módulos de utilidad utilizados desde muchos lugares del plugin. Los ejemplos incluyen manejo de configuración, gestión de señales, gráficas de series temporales y ayudantes de generación de mallas.</p></li>
</ul>
</li>
</ul>
</li>
</ul>
</section>
<section id="lib-package">
<h3><a class="toc-backref" href="#id5" role="doc-backlink"><span class="section-number">3.2.3. </span>Paquete Lib</a><a class="headerlink" href="#lib-package" title="Link to this heading"></a></h3>
<ul>
<li><p><strong>lib/</strong></p>
<ul class="simple">
<li><p>Contiene módulos auxiliares reutilizables que no son específicos de IberGIS y pueden considerarse una pequeña biblioteca de soporte sobre QGIS/PyQt.</p></li>
</ul>
<p>Los módulos típicos incluyen:</p>
<ul class="simple">
<li><p><strong>tools_qgis.py:</strong> Envolturas y ayudantes alrededor de las clases de la API de QGIS.</p></li>
<li><p><strong>tools_qt.py:</strong> Ayudantes para widgets y diálogos de PyQt.</p></li>
<li><p><strong>tools_db.py</strong>, <strong>tools_gpkgdao.py</strong> y <strong>tools_pgdao.py:</strong> Ayudantes de acceso a datos para GeoPackage y PostgreSQL.</p></li>
<li><p><strong>tools_log.py:</strong> Ayudantes de registro utilizados en todo el plugin.</p></li>
</ul>
</li>
</ul>
</section>
<section id="third-party-packages">
<h3><a class="toc-backref" href="#id6" role="doc-backlink"><span class="section-number">3.2.4. </span>Paquetes de Terceros</a><a class="headerlink" href="#third-party-packages" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p><strong>packages/</strong></p>
<ul>
<li><p>Contiene paquetes Python de terceros incluidos utilizados por IberGIS (por ejemplo <code class="docutils literal notranslate"><span class="pre">geopandas</span></code>, ayudantes SWMM, etc.).</p></li>
<li><p>Estos paquetes se tratan como bibliotecas externas y no se espera que sigan completamente las reglas de estilo internas de IberGIS.</p></li>
</ul>
</li>
</ul>
</section>
</section>
<section id="python-coding-rules">
<h2><a class="toc-backref" href="#id7" role="doc-backlink"><span class="section-number">3.3. </span>Reglas de Codificación Python</a><a class="headerlink" href="#python-coding-rules" title="Link to this heading"></a></h2>
<section id="general-style">
<h3><a class="toc-backref" href="#id8" role="doc-backlink"><span class="section-number">3.3.1. </span>Estilo General</a><a class="headerlink" href="#general-style" title="Link to this heading"></a></h3>
<p>IberGIS sigue un estilo que es ampliamente compatible con <a class="reference external" href="https://www.python.org/dev/peps/pep-0008/">PEP 8</a>, con algunas adaptaciones a las necesidades típicas de los plugins QGIS.</p>
<ul class="simple">
<li><p><strong>Line length</strong></p>
<ul>
<li><p>El plugin usa <code class="docutils literal notranslate"><span class="pre">flake8</span></code> con una longitud máxima de línea de <strong>120 caracteres</strong>. Esto permite llamadas típicas a la API de QGIS y cadenas de traducción largas mientras mantiene el código razonablemente legible.</p></li>
<li><p>Las URLs largas o cadenas largas inevitables se marcan explícitamente con <code class="docutils literal notranslate"><span class="pre">#</span> <span class="pre">noqa:</span> <span class="pre">E501</span></code> cuando es necesario.</p></li>
</ul>
</li>
<li><p><strong>Imports</strong></p>
<ul>
<li><p>Primero las importaciones de biblioteca estándar, luego las importaciones de terceros y finalmente las importaciones internas de IberGIS/QGIS.</p></li>
<li><p>Las importaciones del mismo paquete generalmente se agrupan y ordenan por nombre de módulo.</p></li>
</ul>
</li>
<li><p><strong>Indentation and spacing</strong></p>
<ul>
<li><p>Cuatro espacios por nivel de indentación.</p></li>
<li><p>Sin caracteres de tabulación en el código fuente.</p></li>
<li><p>Se utilizan líneas en blanco para separar secciones lógicas (por ejemplo, importaciones, definiciones de clases y grupos de funciones relacionadas).</p></li>
</ul>
</li>
</ul>
</section>
<section id="naming-conventions">
<h3><a class="toc-backref" href="#id9" role="doc-backlink"><span class="section-number">3.3.2. </span>Convenciones de Nomenclatura</a><a class="headerlink" href="#naming-conventions" title="Link to this heading"></a></h3>
<p>Las convenciones de nomenclatura siguen PEP 8 con algunas excepciones específicas de QGIS/Qt para señales y objetos de interfaz.</p>
<ul class="simple">
<li><p>Módulos y paquetes</p>
<ul>
<li><p>Minúsculas con guiones bajos (<code class="docutils literal notranslate"><span class="pre">tools_dr.py</span></code>, <code class="docutils literal notranslate"><span class="pre">tools_qgis.py</span></code>, <code class="docutils literal notranslate"><span class="pre">mesh_parser.py</span></code>).</p></li>
</ul>
</li>
<li><p>Clases</p>
<ul>
<li><p>CapWords / PascalCase (<code class="docutils literal notranslate"><span class="pre">Drain</span></code>, <code class="docutils literal notranslate"><span class="pre">DrMenuLoad</span></code>, <code class="docutils literal notranslate"><span class="pre">DrMainWindow</span></code>).</p></li>
<li><p>Muchas clases usan el prefijo <code class="docutils literal notranslate"><span class="pre">Dr</span></code> para indicar que pertenecen al plugin Drain/IberGIS.</p></li>
</ul>
</li>
<li><p>Funciones y métodos</p>
<ul>
<li><p>Minúsculas con palabras separadas por guiones bajos (<code class="docutils literal notranslate"><span class="pre">init_global</span></code>, <code class="docutils literal notranslate"><span class="pre">init_plugin_settings</span></code>, <code class="docutils literal notranslate"><span class="pre">load_settings</span></code>, <code class="docutils literal notranslate"><span class="pre">initialize_parsers</span></code>).</p></li>
<li><p>Los ayudantes privados o internos comienzan con un guion bajo (<code class="docutils literal notranslate"><span class="pre">_init_plugin()</span></code>, <code class="docutils literal notranslate"><span class="pre">_manage_buttons()</span></code>).</p></li>
</ul>
</li>
<li><p>Variables y atributos</p>
<ul>
<li><p>Minúsculas con guiones bajos para variables locales y atributos de instancia (<code class="docutils literal notranslate"><span class="pre">plugin_dir</span></code>, <code class="docutils literal notranslate"><span class="pre">user_folder_dir</span></code>, <code class="docutils literal notranslate"><span class="pre">project_loaded</span></code>).</p></li>
<li><p>Las constantes y claves de configuración se escriben en MAYÚSCULAS cuando representan valores que no deben cambiar.</p></li>
<li><p>Los diccionarios utilizados como almacenes de datos simples (por ejemplo <code class="docutils literal notranslate"><span class="pre">project_vars</span></code>, <code class="docutils literal notranslate"><span class="pre">session_vars</span></code>, <code class="docutils literal notranslate"><span class="pre">user_level</span></code>) usan claves descriptivas en inglés en minúsculas.</p></li>
</ul>
</li>
<li><p>Señales y ranuras</p>
<ul>
<li><p>Los manejadores de señales Qt generalmente se nombran según la acción que realizan (<code class="docutils literal notranslate"><span class="pre">_set_signals()</span></code>, <code class="docutils literal notranslate"><span class="pre">_unset_signals()</span></code>, <code class="docutils literal notranslate"><span class="pre">_project_read()</span></code>), y se agrupan en regiones en el código fuente para mayor claridad.</p></li>
</ul>
</li>
</ul>
</section>
<section id="global-variables">
<h3><a class="toc-backref" href="#id10" role="doc-backlink"><span class="section-number">3.3.3. </span>Variables Globales</a><a class="headerlink" href="#global-variables" title="Link to this heading"></a></h3>
<p>El estado global está centralizado en <code class="docutils literal notranslate"><span class="pre">global_vars.py</span></code>.</p>
<ul class="simple">
<li><p>Todos los objetos compartidos globalmente (interfaces QGIS, analizadores, registradores, objetos de acceso a datos, etc.) se definen una vez en <code class="docutils literal notranslate"><span class="pre">global_vars</span></code> y se inicializan mediante funciones auxiliares como <code class="docutils literal notranslate"><span class="pre">init_global()</span></code> o <code class="docutils literal notranslate"><span class="pre">init_plugin_settings()</span></code>.</p></li>
<li><p>Otros módulos importan <code class="docutils literal notranslate"><span class="pre">global_vars</span></code> en lugar de definir sus propios singletons globales. Esto mantiene el estado del plugin en un lugar predecible y facilita reiniciar o recargar el plugin durante el desarrollo.</p></li>
</ul>
</section>
<section id="configuration-handling">
<h3><a class="toc-backref" href="#id11" role="doc-backlink"><span class="section-number">3.3.4. </span>Manejo de Configuración</a><a class="headerlink" href="#configuration-handling" title="Link to this heading"></a></h3>
<p>Los archivos de configuración se leen y escriben utilizando funciones auxiliares en <code class="docutils literal notranslate"><span class="pre">core.utils.tools_dr</span></code>.</p>
<ul class="simple">
<li><p>El plugin distingue entre <strong>configuración de usuario</strong> (almacenada en la carpeta de usuario, por ejemplo <code class="docutils literal notranslate"><span class="pre">C:\Users\&lt;USER&gt;\AppData\Roaming\QGIS\&lt;VERSION&gt;\profiles\&lt;PROFILE&gt;\python\plugins\&lt;IBERGIS_FOLDER&gt;\config\user_params.config</span></code>) y <strong>configuración de proyecto</strong> (almacenada en archivos de proyecto).</p></li>
<li><p>Las funciones de conveniencia como <code class="docutils literal notranslate"><span class="pre">get_config_parser()</span></code> y <code class="docutils literal notranslate"><span class="pre">set_config_parser()</span></code> ocultan los detalles de los objetos <code class="docutils literal notranslate"><span class="pre">configparser.ConfigParser</span></code> subyacentes y gestionan automáticamente prefijos por tipo de proyecto cuando es necesario.</p></li>
</ul>
</section>
<section id="error-handling-and-logging">
<h3><a class="toc-backref" href="#id12" role="doc-backlink"><span class="section-number">3.3.5. </span>Manejo de Errores y Registro</a><a class="headerlink" href="#error-handling-and-logging" title="Link to this heading"></a></h3>
<p>El plugin utiliza una combinación de cuadros de mensaje (via <code class="docutils literal notranslate"><span class="pre">tools_qt</span></code>) y archivos de registro (via <code class="docutils literal notranslate"><span class="pre">tools_log</span></code>) para reportar problemas.</p>
<ul class="simple">
<li><p>Las excepciones generalmente se capturan y se envuelven con mensajes informativos, incluyendo el nombre de la función que falló y el texto de la excepción original.</p></li>
<li><p>Las tareas de larga duración que se ejecutan en hilos escriben en el registro para que usuarios y desarrolladores puedan diagnosticar problemas después del hecho.</p></li>
</ul>
</section>
<section id="threaded-operations">
<h3><a class="toc-backref" href="#id13" role="doc-backlink"><span class="section-number">3.3.6. </span>Operaciones en Hilos</a><a class="headerlink" href="#threaded-operations" title="Link to this heading"></a></h3>
<p>Los módulos bajo <code class="docutils literal notranslate"><span class="pre">core/threads/</span></code> implementan operaciones en hilos utilizando las facilidades de hilos de Qt.</p>
<ul class="simple">
<li><p>Las instancias de hilos se rastrean en <code class="docutils literal notranslate"><span class="pre">global_vars.session_vars['threads']</span></code> para que puedan limpiarse cuando el plugin se descarga o reinicia.</p></li>
<li><p>Las actualizaciones de la interfaz desde hilos se realizan usando señales Qt para evitar manipular widgets desde fuera del hilo principal de la GUI.</p></li>
</ul>
</section>
</section>
<section id="working-with-qgis-and-qt">
<h2><a class="toc-backref" href="#id14" role="doc-backlink"><span class="section-number">3.4. </span>Trabajando con QGIS y Qt</a><a class="headerlink" href="#working-with-qgis-and-qt" title="Link to this heading"></a></h2>
<section id="integration-with-qgis">
<h3><a class="toc-backref" href="#id15" role="doc-backlink"><span class="section-number">3.4.1. </span>Integración con QGIS</a><a class="headerlink" href="#integration-with-qgis" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>La clase principal en <code class="docutils literal notranslate"><span class="pre">main.py</span></code> (<code class="docutils literal notranslate"><span class="pre">Drain</span></code>) recibe el objeto de interfaz QGIS (<code class="docutils literal notranslate"><span class="pre">iface</span></code>) y lo almacena en <code class="docutils literal notranslate"><span class="pre">global_vars</span></code>.</p></li>
<li><p>Los ganchos estándar de plugin QGIS están implementados:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">initGui()</span></code>: Crea menús, barras de herramientas y conecta señales.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">unload()</span></code>: Elimina acciones, desconecta señales y cierra diálogos abiertos y widgets acoplables.</p></li>
</ul>
</li>
<li><p>Los proveedores de procesamiento QGIS se registran y desregistran usando <code class="docutils literal notranslate"><span class="pre">QgsApplication.processingRegistry()</span></code> en métodos auxiliares como <code class="docutils literal notranslate"><span class="pre">_initProcessing()</span></code> y <code class="docutils literal notranslate"><span class="pre">_initProcessingMesh()</span></code>.</p></li>
</ul>
</section>
<section id="qt-widgets-and-dialogs">
<h3><a class="toc-backref" href="#id16" role="doc-backlink"><span class="section-number">3.4.2. </span>Widgets y Diálogos Qt</a><a class="headerlink" href="#qt-widgets-and-dialogs" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>Todos los diálogos grandes y widgets acoplables se definen en archivos <code class="docutils literal notranslate"><span class="pre">.ui</span></code> bajo <code class="docutils literal notranslate"><span class="pre">core/ui/</span></code> y se cargan usando clases auxiliares (por ejemplo <code class="docutils literal notranslate"><span class="pre">DrDialog</span></code>, <code class="docutils literal notranslate"><span class="pre">DrMainWindow</span></code>, <code class="docutils literal notranslate"><span class="pre">DrDocker</span></code>).</p></li>
<li><p>El plugin recuerda las preferencias del usuario como el tamaño y posición del diálogo usando los ayudantes de configuración. Funciones como <code class="docutils literal notranslate"><span class="pre">load_settings()</span></code> y <code class="docutils literal notranslate"><span class="pre">save_settings()</span></code> en <code class="docutils literal notranslate"><span class="pre">core.utils.tools_dr</span></code> encapsulan este comportamiento.</p></li>
</ul>
</section>
</section>
<section id="adding-new-code">
<h2><a class="toc-backref" href="#id17" role="doc-backlink"><span class="section-number">3.5. </span>Añadiendo Nuevo Código</a><a class="headerlink" href="#adding-new-code" title="Link to this heading"></a></h2>
<p>Al añadir nuevo código Python a IberGIS, se recomienda:</p>
<ol class="arabic simple">
<li><p>Colocar el nuevo módulo en el paquete más apropiado (<code class="docutils literal notranslate"><span class="pre">core</span></code>, <code class="docutils literal notranslate"><span class="pre">lib</span></code>, <code class="docutils literal notranslate"><span class="pre">core/utils</span></code>, etc.), siguiendo la estructura existente.</p></li>
<li><p>Seguir las convenciones de nomenclatura y estilo descritas anteriormente.</p></li>
<li><p>Mantener la longitud de línea por debajo de 120 caracteres, y solo usar marcadores <code class="docutils literal notranslate"><span class="pre">#</span> <span class="pre">noqa</span></code> cuando sea absolutamente necesario.</p></li>
<li><p>Reutilizar los ayudantes existentes en <code class="docutils literal notranslate"><span class="pre">lib</span></code> y <code class="docutils literal notranslate"><span class="pre">core/utils</span></code> en lugar de duplicar lógica.</p></li>
<li><p>Asegurarse de que cualquier nuevo estado global se añada a <code class="docutils literal notranslate"><span class="pre">global_vars</span></code> y se inicialice desde un único lugar.</p></li>
<li><p>Si el nuevo código añade comportamiento visible para el usuario, crear o actualizar los formularios <code class="docutils literal notranslate"><span class="pre">.ui</span></code> correspondientes y conectarlos a través de los módulos de gestión apropiados.</p></li>
</ol>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Pie de página">
        <a href="dbmodel.html" class="btn btn-neutral float-left" title="2. Modelo de Base de Datos" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Anterior</a>
        <a href="examples.html" class="btn btn-neutral float-right" title="4. Ejemplos" accesskey="n" rel="next">Siguiente <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Derechos de autor 2025, IberGIS.
      <span class="lastupdated">Actualizado por última vez en 2025 dic 12, 12:18 +0100.
      </span></p>
  </div>

  Compilado con <a href="https://www.sphinx-doc.org/">Sphinx</a> usando un
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">tema</a>
    proporcionado por <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <div
	class="rst-versions"
	data-toggle="rst-versions"
	role="note"
	aria-label="versions"
>
	<span class="rst-current-version" data-toggle="rst-current-version">
		<span class="fa fa-info-circle"> IberGIS Documentation </span>
		v: 1.0
		<span class="fa fa-caret-down"></span>
	</span>

	<div class="rst-other-versions">
		<dl>
			<dt>Idiomas</dt>
			
			<dd><a href="https://ibergis.github.io/1.0/en/docs/ibergis/for-developers/developer-manual/python.html">en</a></dd>
			
			<dd><a href="https://ibergis.github.io/1.0/es/docs/ibergis/for-developers/developer-manual/python.html">es</a></dd>
			
		</dl>

		<dl>
			<dt>Versiones</dt>
			
			<dd>
				<a href="https://ibergis.github.io/1.0/es/docs/ibergis/for-developers/developer-manual/python.html">1.0</a>
			</dd>
			
		</dl>

		
	</div>
</div><script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>